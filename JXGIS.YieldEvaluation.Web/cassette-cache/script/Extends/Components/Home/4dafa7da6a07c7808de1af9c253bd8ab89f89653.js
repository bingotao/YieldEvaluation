function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n}function _inherits(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)}var _createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),Cognizance=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={dataState:!1,hasError:!1,activeResult:"review",uploading:!1,cognizancing:!1,errors:[]},i.eventList={closed:"closed"},i._bindFuns(["beforeUpload","onChange","closed","downLoadTemplate","cognizance"]),i.paginationOpts={layout:["sep","first","prev","sep","manual","sep","next","last","info"],onSelectPage:function(n,t){this.$ExcelImportResult.datagrid("loading"),$.post(_bl_+"/Home/GetPageCompanies",{pageNumber:n,pageSize:t},function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):this.$ExcelImportResult.datagrid("loadData",{rows:n.Data.companies,total:n.Data.count}),this.$ExcelImportResult.datagrid("loaded")}.bind(this),"json")}.bind(i)},i}return _inherits(t,n),_createClass(t,[{key:"cognizance",value:function(){antd.message.info("正在认定中..."),this.setState({cognizancing:!0}),$.post(_bl_+"/Home/ImportQYGM",function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):(antd.message.success("导入成功！"),this.setState({cognizancing:!1,dataState:!1,hasError:!1,activeResult:"review",uploading:!1,errors:[]}),this.$ExcelImportResult.datagrid({pageNumber:1}).datagrid("getPager").pagination(this.paginationOpts),this.$ExcelImportResult.datagrid("loadData",{total:0,rows:[]}))}.bind(this),"json")}},{key:"beforeUpload",value:function(n){var t=n.name.split("."),i=t[1]==="xls"||t[1]==="xlsx";return i?this.setState({fileName:n.name,uploading:!0}):(antd.message.error("只能上传Excel格式的数据！"),this.setState({fileName:""})),i}},{key:"onChange",value:function(n){var i,t,u,r;this.$ExcelImportResult.datagrid("loading"),i=n.file,i.status==="uploading"?antd.message.info("文件上传中..."):i.status==="done"?(antd.message.success("文件上传成功！"),t=i.response,t.ErrorMessage?antd.message.error(t.ErrorMessage):(u=t.Data.companies,r=t.Data.errors,this.setState({dataState:r.length===0,hasError:r.length!==0,errors:r,uploading:!1}),this.$ExcelImportResult.datagrid({pageNumber:1}).datagrid("getPager").pagination(this.paginationOpts),this.$ExcelImportResult.datagrid("loadData",{total:t.Data.count,rows:u})),this.$ExcelImportResult.datagrid("loaded")):i.status==="error"&&(antd.message.error("文件上传失败..."),this.$ExcelImportResult.datagrid("loaded"),this.setState({dataState:!1,hasError:!1,uploading:!1}))}},{key:"getErrorResult",value:function(){var n=this.state.errors;return n.map(function(n,t){return React.createElement("div",{className:"error-item"},React.createElement("div",{dangerouslySetInnerHTML:{__html:t+1+"、"+n.Title},className:"error-item-header"}),React.createElement("div",{className:"error-item-errordetails"},n.ErrorMessages.map(function(n,t){return React.createElement("div",{dangerouslySetInnerHTML:{__html:"（"+(t+1)+"） "+n},className:"error-item-errordetail"})})))})}},{key:"downLoadTemplate",value:function(){window.open(_bl_+"/Documents/企业规模认定导入模板.xls")}},{key:"componentDidMount",value:function(){this.$ExcelImportResult=$("#excel_import_result").datagrid({loadMsg:"正在上传并验证数据，请稍后...",pagination:!0,pageSize:10,singleSelect:!0,frozenColumns:[[{field:"INDEX",title:"",align:"center"},{field:"NSRSBH",halign:"center",title:"纳税人识别号"},{field:"NSRMC",halign:"center",title:"纳税人名称"}]],columns:[[{field:"SHXYDM",halign:"center",title:"社会信用代码"},{field:"ZGSWJ_DM",halign:"center",title:"主管税务机构代码"},{field:"SSND",halign:"center",title:"税收年度"},{field:"QYGMMC",halign:"center",title:"企业规模"}]]}).datagrid("loadData",[]),this.$ExcelImportResult.datagrid("getPager").pagination(this.paginationOpts),$(".cognizance").draggable({handle:"#cognizance_title"})}},{key:"closed",value:function(){this.fire(this.eventList.closed,null,!1),$.post(_bl_+"/Home/ClearUploadDatas",function(n){n.ErrorMessage&&antd.message.error(n.ErrorMessage)},"json")}},{key:"render",value:function(){var t=this,n=this.state,i=this.getErrorResult();return React.createElement("div",{className:"cognizance"},React.createElement(antd.Icon,{className:"btn-close",type:"close-circle",onClick:this.closed}),React.createElement("div",{onClick:function(){return t._bringToFront()},id:"cognizance_title",className:"cognizance-title"},"企业规模认定"),React.createElement("table",null,React.createElement("tr",null,React.createElement("th",{style:{width:"30%"}},"认定模式"),React.createElement("td",{style:{width:"70%"}},React.createElement(antd.Select,{onChange:function(n){return t.rdms=n},size:"large",defaultValue:"import",style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:"import"},"外部导入")))),React.createElement("tr",null,React.createElement("th",null,"文件选择"),React.createElement("td",null,React.createElement(antd.Input,{size:"large",style:{width:"200px"},disabled:!0,value:n.fileName||"尚未选择文件"}),React.createElement(antd.Upload,{disabled:n.uploading,onChange:this.onChange,beforeUpload:this.beforeUpload,action:_bl_+"/Home/UploadExcel",multiple:!1,showUploadList:!1},React.createElement(antd.Button,{size:"large",type:"primary",loading:n.uploading},"点击上传")))),React.createElement("tr",null,React.createElement("th",null,"数据状态"),React.createElement("td",null,n.dataState===!1?React.createElement("span",{className:"unverified"},React.createElement(antd.Icon,{type:"close-circle"}),"尚未验证"):React.createElement("span",{className:"verified"},React.createElement(antd.Icon,{type:"check-circle"}),"已验证"))),React.createElement("tr",null,React.createElement("td",{colSpan:2,style:{"text-align":"center"}},React.createElement(antd.Button,{onClick:this.downLoadTemplate,size:"large",type:"primary"},"模板下载"),"   ",React.createElement(antd.Button,{loading:n.cognizancing,onClick:this.cognizance,disabled:!n.dataState,size:"large",type:"primary"},"开始认证")))),React.createElement("div",{className:"table-panel"},React.createElement("ul",{className:"result-nav"},React.createElement("li",{onClick:function(){return t.setState({activeResult:"review"})},className:this._getClass(n.activeResult==="review")},"数据预览"),React.createElement("li",{onClick:function(){return t.setState({activeResult:"error"})},className:this._getClass(n.activeResult==="error")},"错误信息")),React.createElement("div",{className:this._getClass(n.activeResult==="review")},React.createElement("table",{id:"excel_import_result",style:{height:"260px"}})),React.createElement("div",{className:this._getClass(n.activeResult==="error")},n.hasError?"":React.createElement("div",{className:"none-error-tip"},"无错误信息"),i)))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),SingleCognizance=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={showPanel:!1,entity:{},departments:[]},i.eventList={closed:"closed"},i._bindFuns(["closed","newRecord","save","getQYGM"]),i.newEntity=i.getNewEntity(),i.ssnd=2016,i.zgswj_dm="all",i}return _inherits(t,n),_createClass(t,[{key:"getConditions",value:function(){return{ssnd:this.ssnd,zgswj_dm:this.zgswj_dm,nsrmc:this.nsrmc,nsrsbh:this.nsrsbh}}},{key:"save",value:function(){var n=this.newEntity,t=this.state.entity;$.post(_bl_+"/Home/SaveQYGM",{oldEntity:t,newEntity:n},function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):(antd.message.success("保存成功！"),this.setState({showPanel:!1}),this.getQYGM())}.bind(this),"json")}},{key:"closed",value:function(){this.fire(this.eventList.closed,null,!1)}},{key:"getDepartments",value:function(){var n=this,t=this.state.departments,i=t.map(function(n){return React.createElement(antd.Select.Option,{className:"ct-option",value:n.SWJG_DM},n.SWJGMC)});return React.createElement(antd.Select,{size:"large",onSelect:function(t){return n.zgswj_dm=t},defaultValue:this.zgswj_dm,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:"all"},"全部"),i)}},{key:"getDepartments2",value:function(){var r=this,u=this.state.departments,n=this.state.entity,t,i;return this.newEntity.ZGSWJ_DM=n.ZGSWJ_DM?n.ZGSWJ_DM:"",t=u.map(function(n){return React.createElement(antd.Select.Option,{className:"ct-option",value:n.SWJG_DM},n.SWJGMC)}),i=React.createElement(antd.Select,{onSelect:function(n){return r.newEntity.ZGSWJ_DM=n},size:"large",defaultValue:this.newEntity.ZGSWJ_DM,style:{width:200}},t),i}},{key:"getNewEntity",value:function(){return{SSND:2016,QYGM:0}}},{key:"newRecord",value:function(){this.newEntity=this.getNewEntity(),this.setState({entity:{},showPanel:!0})}},{key:"componentDidMount",value:function(){var n,t;$(".singlecognizance").draggable({handle:"#singlecognizance_header"}),$.post(_bl_+"/Home/GetDepartments",function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):this.setState({departments:n.Data})}.bind(this),"json"),n={singleSelect:!0,rownumbers:!0,pagination:!0,pageSize:10,pageList:[10],columns:[[{field:"NSRSBH",title:"纳税人识别号",halign:"center",width:160},{field:"NSRMC",title:"纳税人名称",halign:"center",width:220},{field:"SHXYDM",title:"社会信用代码",halign:"center",width:160},{field:"SSND",title:"所属年度",halign:"center",width:80},{field:"ZGSWJ_DM",title:"主管税务局代码",halign:"center",width:160},{field:"QYGMMC",title:"企业规模",halign:"center",width:80}]],toolbar:[{text:"新增",iconCls:"anticon anticon-plus",handler:this.newRecord},"-",{text:"删除",iconCls:"anticon anticon-minus",handler:function(){var n=this.$datagrid.datagrid("getSelected");if(!n)return antd.message.error("请选择要删除的数据！"),!1;$.messager.confirm("提醒","确定删除该条记录？",function(t){t&&$.post(_bl_+"/Home/DeleteQYGM",n,function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):(antd.message.success("删除成功！"),this.getQYGM())}.bind(this))}.bind(this))}.bind(this)},"-",{text:"修改",iconCls:"anticon anticon-edit",handler:function(){var n=this.$datagrid.datagrid("getSelected");n?(this.newEntity={NSRSBH:n.NSRSBH,NSRMC:n.NSRMC,SHXYDM:n.SHXYDM,ZGSWJ_DM:n.ZGSWJ_DM,SSND:n.SSND,QYGM:n.QYGM},this.setState({entity:n,showPanel:!0})):antd.message.error("请选择要编辑的数据！")}.bind(this)}]},n.queryParams=this.getConditions(),n.url=_bl_+"/Home/GetQYGM",this.datagridConfig=n,t=$("#singlecognizance_grid").datagrid(n),this.$datagrid=t}},{key:"getQYGM",value:function(){this.datagridConfig.queryParams=this.getConditions(),this.datagridConfig.url=_bl_+"/Home/GetQYGM",this.$datagrid.datagrid(this.datagridConfig)}},{key:"render",value:function(){var n=this,i=this.state,t=i.entity;return React.createElement("div",{className:"singlecognizance"},React.createElement(antd.Icon,{className:"btn-close",type:"close-circle",onClick:this.closed}),React.createElement("div",{id:"singlecognizance_header"},"企业规模认定"),React.createElement("div",{className:"singlecognizance-conditions"},React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"所属年度"),React.createElement("td",null,React.createElement(antd.Select,{size:"large",onSelect:function(t){return n.ssnd=t},defaultValue:this.ssnd,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:""},"2016"))),React.createElement("th",null,"税务部门"),React.createElement("td",null,this.getDepartments())),React.createElement("tr",null,React.createElement("th",null,"纳税人识别号"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.nsrsbh=t.target.value},size:"large",style:{width:200}})),React.createElement("th",null,"企业名称"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.nsrmc=t.target.value},size:"large",style:{width:200}}))),React.createElement("tr",null,React.createElement("td",{colSpan:"4",style:{"text-align":"center"}},React.createElement(antd.Button,{onClick:this.getQYGM,type:"primary",size:"large"},"查询"))))),React.createElement("div",{className:"singlecognizance-results"},React.createElement("table",{id:"singlecognizance_grid",style:{height:315}})),i.showPanel&&React.createElement("div",{className:"singlecognizance-panel"},React.createElement("div",null,t.NSRSBH?"修改单户企业":"新增单户企业"),React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"所属年度"),React.createElement("td",null,React.createElement(antd.Select,{size:"large",onSelect:function(t){return n.newEntity.SSND=t},defaultValue:t.SSND||2016,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:2016},"2016年")))),React.createElement("tr",null,React.createElement("th",null,"社会信用代码"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.newEntity.SHXYDM=t.target.value},style:{width:200},defaultValue:t.SHXYDM}))),React.createElement("tr",null,React.createElement("th",null,"纳税人识别号"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.newEntity.NSRSBH=t.target.value},style:{width:200},defaultValue:t.NSRSBH}))),React.createElement("tr",null,React.createElement("th",null,"企业名称"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.newEntity.NSRMC=t.target.value},style:{width:200},defaultValue:t.NSRMC}))),React.createElement("tr",null,React.createElement("th",null,"税务部门编码"),React.createElement("td",null,this.getDepartments2())),React.createElement("tr",null,React.createElement("th",null,"企业规模"),React.createElement("td",null,React.createElement(antd.Select,{onSelect:function(t){return n.newEntity.QYGM=t},size:"large",defaultValue:t.QYGM?t.QYGM:0,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:1},"规 上"),React.createElement(antd.Select.Option,{className:"ct-option",value:2},"规 下"),React.createElement(antd.Select.Option,{className:"ct-option",value:0},"未确定")))),React.createElement("tr",null,React.createElement("td",{colSpan:"2",style:{"text-align":"center"}},React.createElement(antd.Button,{onClick:this.save,type:"primary"},"保存"),"   ",React.createElement(antd.Button,{onClick:function(){return n.setState({showPanel:!1})},type:"default"},"取消"))))))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),DataProcessing=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={processType:"全库",departments:[]},i.eventList={closed:"closed"},i._bindFuns(["closed","process"]),i.sjnf=2016,i}return _inherits(t,n),_createClass(t,[{key:"process",value:function(){antd.message.info("数据正在加工中，请稍后...");var n=this.getCondition();$.post(_bl_+"/Home/DataProcess",n,function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):(antd.message.info(n.Data),this.fire(this.eventList.closed))}.bind(this),"json")}},{key:"getCondition",value:function(){return{sjnf:this.sjnf,jgms:this.state.processType,swbm:this.swbm,dsbm:this.dsbm}}},{key:"getDepartments",value:function(){var r=this,n=this.state.departments,t,i;return this.swbm=n.length?n[0].SWJG_DM:null,t=n.map(function(n){return React.createElement(antd.Select.Option,{className:"ct-option",value:n.SWJG_DM},n.SWJGMC)}),i=React.createElement(antd.Select,{onChange:function(n){return r.swbm=n},size:"large",defaultValue:this.swbm,style:{width:200}},t),i}},{key:"componentDidMount",value:function(){$(".dataprocessing").draggable({handle:"#dataprocessing_header"}),$.post(_bl_+"/Home/GetDepartments",function(n){if(n.ErrorMessage)antd.message.error(n.ErrorMessage);else{var t=n.Data;this.setState({departments:t})}}.bind(this),"json")}},{key:"closed",value:function(){this.fire(this.eventList.closed,null,!1)}},{key:"render",value:function(){var t=this,n=this.state,i=this.getDepartments();return React.createElement("div",{className:"dataprocessing"},React.createElement(antd.Icon,{className:"btn-close",type:"close-circle",onClick:this.closed}),React.createElement("div",{id:"dataprocessing_header"},"亩产数据加工"),React.createElement("div",null,React.createElement("table",null,React.createElement("tr",null,React.createElement("th",null,"数据年份"),React.createElement("td",null,React.createElement(antd.Select,{onChange:function(n){return t.sjnf=n},size:"large",defaultValue:this.sjnf,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:"2016"},"2016年")))),React.createElement("tr",null,React.createElement("th",null,"加工模式"),React.createElement("td",null,React.createElement(antd.Select,{value:n.processType,onChange:function(n){return t.setState({processType:n})},size:"large",defaultValue:n.processType,style:{width:200}},React.createElement(antd.Select.Option,{className:"ct-option",value:"全库"},"全库"),React.createElement(antd.Select.Option,{className:"ct-option",value:"单户"},"单户"),React.createElement(antd.Select.Option,{className:"ct-option",value:"税务部门"},"税务部门")))),n.processType==="单户"?React.createElement("tr",null,React.createElement("th",null,"地税编码"),React.createElement("td",null,React.createElement(antd.Input,{size:"large",style:{width:200},onChange:function(n){return t.dsbm=n.target.value}}))):null,n.processType==="税务部门"?React.createElement("tr",null,React.createElement("th",null,"税务部门"),React.createElement("td",null,i)):null,React.createElement("tr",null,React.createElement("td",{colSpan:"2"},React.createElement(antd.Button,{size:"large",type:"primary",onClick:this.process},"加工"))))))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),EnterpriseSort=function(n){function t(n){var i,r;return _classCallCheck(this,t),i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n)),i.state={departments:[]},i.eventList={closed:"closed",OKClick:"OKClick"},i._bindFuns(["closed","OKClick"]),i.tjnf=2016,i.qygm=9,r=React.createElement("div",null,React.createElement(antd.Select.Option,{className:"ct-option",value:1},"规 上"),React.createElement(antd.Select.Option,{className:"ct-option",value:2},"规 下"),React.createElement(antd.Select.Option,{className:"ct-option",value:0},"未确定")),i}return _inherits(t,n),_createClass(t,[{key:"closed",value:function(){this.fire(this.eventList.closed,null,!1)}},{key:"OKClick",value:function(){var n=this.getOptions();this.fire(this.eventList.OKClick,n,!1)}},{key:"getOptions",value:function(){return{SSND:this.tjnf,ZGSWJ_DM:this.swbm,SZPQ:this.szpq,MJ_Min:this.mj_min,MJ_Max:this.mj_max,QYGM:this.qygm,HYDM:this.refs.industryTree.getIndustries()}}},{key:"componentDidMount",value:function(){$(".enterprise-sort").draggable({handle:"#enterprise_sort_title"}),$.post(_bl_+"/Home/GetDepartments",function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):this.setState({departments:n.Data})}.bind(this),"json")}},{key:"render",value:function(){var n=this,t=this.state,i=t.departments.map(function(n){return React.createElement(antd.Select.Option,{className:"ct-option",value:n.SWJG_DM},n.SWJGJC)});return React.createElement("div",{className:"enterprise-sort"},React.createElement(antd.Icon,{className:"btn-close",type:"close-circle",onClick:this.closed}),React.createElement("div",{onClick:function(){return n._bringToFront()},id:"enterprise_sort_title",className:"enterprise-sort-title"},"亩产税收排名"),React.createElement("div",{className:"enterprise-sort-left"},React.createElement(IndustryTree,{ref:"industryTree"})),React.createElement("div",{className:"enterprise-sort-right"},React.createElement("table",null,React.createElement("tr",null,React.createElement("th",{style:{width:"40%"}},"统计年份"),React.createElement("td",{style:{width:"60%"}},React.createElement(antd.Select,{onChange:function(t){return n.tjnf=t},size:"large",defaultValue:2016,style:{width:180}},React.createElement(antd.Select.Option,{className:"ct-option",value:2016},"2016 年"),React.createElement(antd.Select.Option,{className:"ct-option",value:2015},"2015 年"),React.createElement(antd.Select.Option,{className:"ct-option",value:2014},"2014 年"),React.createElement(antd.Select.Option,{className:"ct-option",value:2013},"2013 年")))),React.createElement("tr",null,React.createElement("th",null,"税务部门"),React.createElement("td",null,React.createElement(antd.Select,{onChange:function(t){return n.swbm=t},size:"large",defaultValue:"all",style:{width:180}},React.createElement(antd.Select.Option,{className:"ct-option",value:"all"},"全 部"),i))),React.createElement("tr",null,React.createElement("th",null,"所在片区"),React.createElement("td",null,React.createElement(antd.Input,{onChange:function(t){return n.szpq=t.target.value},size:"large"}))),React.createElement("tr",null,React.createElement("th",null,"面  积"),React.createElement("td",null,React.createElement(antd.InputNumber,{min:0,onChange:function(t){return n.mj_min=t},style:{width:65},defaultValue:0,size:"large"})," ~ ",React.createElement(antd.InputNumber,{min:0,onChange:function(t){return n.mj_max=t},style:{width:65},defaultValue:0,size:"large"})," 亩")),React.createElement("tr",null,React.createElement("th",null,"企业规模"),React.createElement("td",null,React.createElement(antd.Select,{onChange:function(t){return n.qygm=t},size:"large",defaultValue:9,style:{width:180}},React.createElement(antd.Select.Option,{className:"ct-option",value:9},"全 部"))))),React.createElement("div",null,React.createElement(antd.Button,{onClick:this.OKClick,size:"large",type:"primary"},"确定")," ",React.createElement(antd.Button,{onClick:this.closed,size:"large"},"取消"))))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),HomeIndex=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={showCognizance:!1,showEnterpriseSort:!1,showSortResult:!1,showDataProcessing:!1,showSingleCognizance:!1,showProcessingResult:!1,showLogin:!0},i._bindFuns(["closeSortResult"]),i}return _inherits(t,n),_createClass(t,[{key:"closeSortResult",value:function(){this.setState({showSortResult:!1})}},{key:"componentDidMount",value:function(){var t=this.refs,n=t.cTools,i;n.on(n.eventList.cognizance,function(){this.setState({showCognizance:!0},function(){var n=this.refs.cCognizance;n&&n.on(n.eventList.closed,function(){this.setState({showCognizance:!1})}.bind(this)),n._bringToFront()}.bind(this))}.bind(this));n.on(n.eventList.enterpriseSort,function(){this.setState({showEnterpriseSort:!0},function(){var n=this.refs.cEnterpriseSort;n&&n.on(n.eventList.closed,function(){this.setState({showEnterpriseSort:!1})}.bind(this)),n&&n.on(n.eventList.OKClick,function(n){var t=n.data;$.post(_bl_+"/Home/UpSortCondition",t,function(n){n.ErrorMessage?antd.message.error(n.ErrorMessage):this.setState({showSortResult:!0})}.bind(this))}.bind(this)),n._bringToFront()}.bind(this))}.bind(this));n.on(n.eventList.dataProcessing,function(n){var t=n.data.dataProcessingType;this.setState({showDataProcessing:!0},function(){var n=this.refs.cDataProcessing;n.setState({processType:t}),n&&n.on(n.eventList.closed,function(){this.setState({showDataProcessing:!1})}.bind(this))})}.bind(this));n.on(n.eventList.singleCognizance,function(){this.setState({showSingleCognizance:!0},function(){var n=this.refs.cSingleCognizance;n&&n.on(n.eventList.closed,function(){this.setState({showSingleCognizance:!1})}.bind(this))})}.bind(this));n.on(n.eventList.processingResult,function(){this.setState({showProcessingResult:!0},function(){var n=this.refs.cProcessingResult;n&&n.on(n.eventList.closed,function(){this.setState({showProcessingResult:!1})}.bind(this))})}.bind(this));if(t.cLogin){i=t.cLogin;i.on(i.eventList.login,function(n){n.data&&this.setState({showLogin:!1})},this)}}},{key:"render",value:function(){var n=this.state;return React.createElement("div",{className:"home-index"},React.createElement("div",{className:"home-index-header"}),React.createElement("div",{className:"home-index-body"},React.createElement(Tools,{ref:"cTools"}),React.createElement(MainMap,null)),n.showCognizance&&React.createElement(Cognizance,{ref:"cCognizance"}),n.showEnterpriseSort&&React.createElement(EnterpriseSort,{ref:"cEnterpriseSort"}),n.showDataProcessing&&React.createElement(DataProcessing,{ref:"cDataProcessing"}),n.showSingleCognizance&&React.createElement(SingleCognizance,{ref:"cSingleCognizance"}),n.showProcessingResult&&React.createElement(ProcessingResult,{ref:"cProcessingResult"}),n.showLogin&&React.createElement(Login,{ref:"cLogin"}),React.createElement("div",{className:"sort-result "+this._getClass(n.showSortResult)},React.createElement(antd.Icon,{type:"close-circle",className:"btn-close",onClick:this.closeSortResult}),n.showSortResult?React.createElement("iframe",{frameBorder:"0",id:"sortFrame",src:_bl_+"/Home/EnterpriseSortPage"}):null))}}]),t}(React.Component),IndustryTree,Login,MainMap,ProcessingResult,Tools;$(function(){var n=ReactDOM.render(React.createElement(HomeIndex,null),document.getElementById("app"))}),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),IndustryTree=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={treeData:[],checkedAll:!1},i._bindFuns(["onNodeChecked","onSelectAllChange"]),i}return _inherits(t,n),_createClass(t,[{key:"onNodeChecked",value:function(n){this.checkedKeys=n}},{key:"getIndustries",value:function(){return this.checkedKeys}},{key:"getTree",value:function(){function t(n,i){return n.map(function(n){return i.push(n.HY_DM),n.Children&&n.Children.length>0?React.createElement(antd.Tree.TreeNode,{title:n.HY_DM==="all"?n.HYMC:"("+n.HY_DM+") "+n.HYMC,key:n.HY_DM},t(n.Children,i)):React.createElement(antd.Tree.TreeNode,{title:"("+n.HY_DM+") "+n.HYMC,key:n.HY_DM})})}var i=this.state,r=i.treeData,n=[],u=t(r,n);return this.nodeIDs||(this.nodeIDs=n),React.createElement(antd.Tree,{defaultExpandedKeys:["all"],checkable:!0,onCheck:this.onNodeChecked},u)}},{key:"componentDidMount",value:function(){$.post(_bl_+"/Home/GetIndustryTree",function(n){if(n.ErrorMessage)antd.message.error(n.ErrorMessage);else{var t=n.Data;this.setState(this._getUpdateStateFun({treeData:[{HY_DM:"all",HYMC:"全选",Children:t}]}))}}.bind(this),"json")}},{key:"onSelectAllChange",value:function(n){this.setState(this._getUpdateStateFun({checkedAll:n.target.checked}))}},{key:"render",value:function(){var t=this.state,n=this.getTree();return React.createElement("div",{className:"industry-tree"},React.createElement("div",{className:"industry-tree-header"},"所属行业"),React.createElement("div",{className:"industry-tree-body"},n))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),Login=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={userActive:!1,passwordActive:!1},i.eventList={login:"login"},i._bindFuns(["login"]),i}return _inherits(t,n),_createClass(t,[{key:"login",value:function(){var n=this.refs.user.value,t=this.refs.password.value;n&&t?(n=n.trim(),t=t.trim(),$.post(_bl_+"/Common/Login",{userName:n,password:t},function(n){n.ErrorMessage||!n.Data?antd.message.error("登录失败，用户名密码错误！"):antd.message.info("登录成功"),this.fire(this.eventList.login,n.Data,!1)}.bind(this),"json")):antd.message.error("请填写用户名密码！")}},{key:"componentDidMount",value:function(){$.post(_bl_+"/Common/Login",function(n){this.fire(this.eventList.login,n.Data,!1)}.bind(this),"json")}},{key:"render",value:function(){var n=this,t=this.state;return React.createElement("div",{className:"login"},React.createElement("form",{name:"login"},React.createElement("div",{className:"login-content"},React.createElement("div",null,"亩产税收管理系统"),React.createElement("div",{className:"group "+this._getClass(t.userActive)},React.createElement(antd.Icon,{type:"user"}),React.createElement("input",{ref:"user",onFocus:function(){return n.setState({userActive:!0})},onBlur:function(){return n.setState({userActive:!1})},name:"UserName",type:"text",placeholder:"请输入用户名"})),React.createElement("div",{className:"group "+this._getClass(t.passwordActive)},React.createElement(antd.Icon,{type:"key"}),React.createElement("input",{ref:"password",onFocus:function(){return n.setState({passwordActive:!0})},onBlur:function(){return n.setState({passwordActive:!1})},name:"Password",type:"password",placeholder:"请输入密码"})),React.createElement("span",{onClick:this.login,className:"bb-comment-btn"},React.createElement("span",{className:"glyphicon glyphicon-log-in"}),"    登  录"))))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),MainMap=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={},i}return _inherits(t,n),_createClass(t,[{key:"initMap",value:function(){var n="http://144.32.16.71:9001/JXPDServerCore/rest/services/DTMapService/MapServer",t="http://144.32.16.71:9001/JXPDServerCore/rest/services/JJMapService/MapServer";require(["esri/map","esri/layers/ArcGISTiledMapServiceLayer","esri/dijit/Scalebar"],function(i,r,u){map=new i("map",{logo:!1,sliderPosition:"top-right",center:[120.75013,30.76367],zoom:1});var o=new u({map:map,attachTo:"bottom-left",scalebarStyle:"line",scalebarUnit:"metric"}),f=new r(n),e=new r(t);map.addLayers([f,e])})}},{key:"componentDidMount",value:function(){this.initMap()}},{key:"render",value:function(){return React.createElement("div",{id:"map"})}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),ProcessingResult=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={},i.eventList={closed:"closed"},i._bindFuns(["closed"]),i}return _inherits(t,n),_createClass(t,[{key:"componentDidMount",value:function(){$(".processingresult").draggable({handle:"#processingresult_header"});var n={url:_bl_+"/Home/GetSJJGLS",rownumbers:!0,columns:[[{field:"LOGDATE",title:"时间",halign:"center"},{field:"LOGTYPE",title:"类型",halign:"center"},{field:"LOGCONTENT",title:"内容",halign:"center"}]]};$("#processing_result").datagrid(n)}},{key:"closed",value:function(){this.fire(this.eventList.closed,null,!1)}},{key:"render",value:function(){var n=this.state;return React.createElement("div",{className:"processingresult"},React.createElement(antd.Icon,{className:"btn-close",type:"close-circle",onClick:this.closed}),React.createElement("div",{id:"processingresult_header"},"加工进度查看"),React.createElement("table",{id:"processing_result",style:{height:"250px"}}))}}]),t}(React.Component),_createClass=function(){function n(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}return function(t,i,r){return i&&n(t.prototype,i),r&&n(t,r),t}}(),Tools=function(n){function t(n){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,n));return i.state={},i.eventList={cognizance:"cognizance",enterpriseSort:"enterpriseSort",dataProcessing:"dataProcessing",singleCognizance:"singleCognizance",processingResult:"processingResult"},i._bindFuns(["cognizance","enterpriseSort","dataProcessing","singleCognizance","processingResult"]),i.dataProcessingType={dh:"单户",fj:"税务部门",qk:"全库"},i}return _inherits(t,n),_createClass(t,[{key:"cognizance",value:function(){this.fire(this.eventList.cognizance,null,!1)}},{key:"enterpriseSort",value:function(){this.fire(this.eventList.enterpriseSort,null,!1)}},{key:"dataProcessing",value:function(n){this.fire(this.eventList.dataProcessing,{dataProcessingType:n},!1)}},{key:"singleCognizance",value:function(){this.fire(this.eventList.singleCognizance,null,!1)}},{key:"processingResult",value:function(){this.fire(this.eventList.processingResult,null,!1)}},{key:"render",value:function(){var n=this,t=this.state;return React.createElement("div",{className:"tools"},React.createElement("ul",null,React.createElement("li",null,React.createElement("span",null,React.createElement(antd.Icon,{type:"book"}),"企业清册"),React.createElement("ul",null,React.createElement("li",null,"所有正常企业清册"),React.createElement("li",null,"参与排名企业清册"),React.createElement("li",{className:"split"}),React.createElement("li",null,"按地税编码查询"),React.createElement("li",null,"按企业名称查询"),React.createElement("li",null,"按所属行业查询"),React.createElement("li",null,"按管理分局查询"),React.createElement("li",{className:"split"}),React.createElement("li",null,"按土地坐落查询"),React.createElement("li",null,"按土地面积查询"),React.createElement("li",null,"按土地等级查询"),React.createElement("li",null,"按企业名称查询"))),React.createElement("li",null,React.createElement("span",null,React.createElement(antd.Icon,{type:"area-chart"}),"亩产排名"),React.createElement("ul",null,React.createElement("li",{onClick:this.singleCognizance},"单户排名企业认定"),React.createElement("li",{onClick:this.cognizance},"分局排名企业认定"),React.createElement("li",{onClick:this.cognizance},"全部排名企业认定"),React.createElement("li",{className:"split"}),React.createElement("li",{onClick:function(){return n.dataProcessing(n.dataProcessingType.dh)}},"单户企业数据加工"),React.createElement("li",{onClick:function(){return n.dataProcessing(n.dataProcessingType.fj)}},"分局企业数据加工"),React.createElement("li",{onClick:function(){return n.dataProcessing(n.dataProcessingType.qk)}},"全部企业数据加工"),React.createElement("li",{onClick:this.processingResult},"加工进度查看"),React.createElement("li",{className:"split"}),React.createElement("li",{onClick:this.enterpriseSort},"亩产税收排名查询"),React.createElement("li",null,"亩产税收图表生成"))),React.createElement("li",null,React.createElement("span",null,React.createElement(antd.Icon,{type:"environment"}),"地图定位"),React.createElement("ul",null,React.createElement("li",null,"企业地址定位"),React.createElement("li",null,"土地地址定位"),React.createElement("li",null,"门牌地址查询"),React.createElement("li",null,"企业地址定位历史"))),React.createElement("li",null,React.createElement("span",null,React.createElement(antd.Icon,{type:"global"}),"地图管理"),React.createElement("ul",null,React.createElement("li",null,"企业迁址模拟定点"),React.createElement("li",null,"税收同比图警示指标设置"),React.createElement("li",{className:"split"}),React.createElement("li",null,"距离测量"),React.createElement("li",null,"面积测量"),React.createElement("li",null,"地图打印"),React.createElement("li",null,"清除图册"),React.createElement("li",null,"书签管理"),React.createElement("li",null,"地图标注绘制管理"))),React.createElement("li",null,React.createElement("span",null,React.createElement(antd.Icon,{type:"user"}),"用户管理"),React.createElement("ul",null,React.createElement("li",null,"用户账号管理"),React.createElement("li",null,"用户权限管理"),React.createElement("li",null,"龙版用户同步"),React.createElement("li",{className:"split"}),React.createElement("li",null,"重新登录")))))}}]),t}(React.Component)