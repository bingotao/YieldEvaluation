function __extend__(n){for(var i,r,t=1,u=arguments.length;t<u;t++){r=arguments[t];for(i in r)n[i]=r[i]}return n}function __leafletExtends__(){window.L&&(Number.prototype.toRadians===undefined&&(Number.prototype.toRadians=function(){return this*Math.PI/180}),Number.prototype.toDegrees===undefined&&(Number.prototype.toDegrees=function(){return this*180/Math.PI}),L.extend(L.CRS.Earth,{destinationPoint:function(n,t,i,r){r=r===undefined?this.R:Number(r);var u=Number(t)/r,f=Number(i).toRadians(),e=n.lat.toRadians(),a=n.lng.toRadians(),o=Math.sin(e),s=Math.cos(e),h=Math.sin(u),c=Math.cos(u),v=Math.sin(f),y=Math.cos(f),l=o*c+s*h*y,p=Math.asin(l),w=v*h*s,b=c-o*l,k=a+Math.atan2(w,b);return L.latLng(p.toDegrees(),(k.toDegrees()+540)%360-180)}}),L.Circle.include({toGeoJSON2:function(n){for(var u=(n||1)*36,f=this.options.radius,e=this._latlng,r=[],o=360/u,i,t=0;t<=360;t+=o)i=L.CRS.Earth.destinationPoint(e,f,t),r.push([i.lng,i.lat]);return L.GeoJSON.getFeature(this,{type:"Polygon",coordinates:[r]})}}),L.TileLayer.TDTJX=L.TileLayer.extend({urls:{vec:{g:{url:"http://t0.tianditu.com/vec_c/wmts",options:{layer:"vec",tilematrixSet:"c",format:"tile"}},s:{url:"http://srv.zjditu.cn/ZJEMAP_2D/wmts",options:{layer:"ZJEMAP_2D",tilematrixSet:"esritilematirx",format:"image/png"}},d:{url:"http://220.191.220.90/JXEMAP/service/wmts",options:{layer:"JXEMAP",tilematrixSet:"TileMatrixSet0",format:"image/png"}}},vec_anno:{g:{url:"http://t0.tianditu.com/cva_c/wmts",options:{layer:"cva",tilematrixSet:"c",format:"tile"}},s:{url:"http://srv.zjditu.cn/ZJEMAPANNO_2D/wmts",options:{layer:"ZJEMAPANNO_2D",tilematrixSet:"esritilematirx",format:"image/png"}},d:{url:"http://220.191.220.90/JXEMAPANNO/service/wmts",options:{layer:"JXEMAPANNO",tilematrixSet:"TileMatrixSet0",format:"image/png"}}},img:{g:{url:"http://t0.tianditu.com/img_c/wmts",options:{layer:"img",tilematrixSet:"c",format:"tile"}},s:{url:"http://srv.zjditu.cn/ZJDOM_2D/wmts",options:{layer:"ZJDOM_2D",tilematrixSet:"esritilematirx",format:"image/jpeg"}},d:{url:"http://220.191.220.90/JXIMG/service/wmts",options:{layer:"JXIMG",tilematrixSet:"TileMatrixSet0",format:"image/png"}}},img_anno:{g:{url:"http://t0.tianditu.com/cia_c/wmts",options:{layer:"cia",tilematrixSet:"c",format:"tile"}},s:{url:"http://srv.zjditu.cn/ZJDOMANNO_2D/wmts",options:{layer:"ZJDOMANNO_2D",tilematrixSet:"esritilematirx",format:"image/png"}},d:{url:"http://220.191.220.90/JXIMGANNO/service/wmts",options:{layer:"JXIMGANNO",tilematrixSet:"TileMatrixSet0",format:"image/png"}}}},initialize:function(n){var i,u,f,t,r;this.type=n.type,L.extend(this.options,n),this.options.maxZoom=20,this.options.minZoom=2,i=256,u={width:i,height:i,service:"WMTS",request:"GetTile",version:"1.0.0",tileSize:256,style:"default",errorTileUrl:"http://10.73.1.48/geosoc/Content/img/error.png"};for(f in this.urls){t=this.urls[f];for(r in t)t[r].options=L.extend(t[r].options,u)}this.matrixIds=this.getDefaultMatrix()},onAdd:function(n){L.TileLayer.prototype.onAdd.call(this,n)},getTileUrl:function(n){var i=this._map,r,t;return crs=i.options.crs,tileSize=256,nwPoint=n.multiplyBy(tileSize),nwPoint.x+=1,nwPoint.y-=1,zoom=n.z,sePoint=nwPoint.add(new L.Point(tileSize,tileSize)),nw=crs.project(i.unproject(nwPoint,zoom)),se=crs.project(i.unproject(sePoint,zoom)),tilewidth=se.x-nw.x,ident=this.matrixIds[zoom].identifier,X0=this.matrixIds[zoom].topLeftCorner.lng,Y0=this.matrixIds[zoom].topLeftCorner.lat,tilecol=Math.floor((nw.x-X0)/tilewidth),tilerow=-Math.floor((nw.y-Y0)/tilewidth),r=this.getUrlOption(this.type,zoom),t=r.url,t=L.Util.template(t,{s:this._getSubdomain(n)}),t+L.Util.getParamString(r.options,t)+"&tilematrix="+ident+"&tilerow="+tilerow+"&tilecol="+tilecol},getUrlOption:function(n,t){return this._getUrlOptionsByZoom(this.urls[n],t)},_getUrlOptionsByZoom:function(n,t){return t<14?n.g:t<18?n.s:n.d},setParams:function(n,t){return L.extend(this.wmtsParams,n),t||this.redraw(),this},getDefaultMatrix:function(){for(var t=new Array(22),n=0;n<22;n++)t[n]={identifier:""+n,topLeftCorner:new L.LatLng(90,-180)};return t}}),L.tileLayer.TDTJX=function(n){return new L.TileLayer.TDTJX(n)},L.CRS.EPSG4490=L.extend({},L.CRS.Earth,{code:"EPSG:4490",projection:L.Projection.LonLat,transformation:new L.Transformation(1/360,.5,-1/360,.5)}),L.Draw&&(L.Draw.Feature.include({_fireCreatedEvent:function(n){var t={layer:n,layerType:this.type};this.fire(L.Draw.Event.CREATED,t),this._map.fire(L.Draw.Event.CREATED,t)},toggleEnable:function(){this._enabled?this.disable():this.enable()}}),L.Draw.initDraw=function(n,t,i){var r=L.Draw.Marker;t=t&&t.toLowerCase?t.toLowerCase():null;switch(t){case"circle":r=L.Draw.Circle;break;case"polyline":r=L.Draw.Polyline;break;case"polygon":r=L.Draw.Polygon;break;case"rectangle":r=L.Draw.Rectangle;break;default:r=L.Draw.Marker}return new r(n,i)},L.drawLocal={draw:{toolbar:{actions:{title:"取消",text:"取消"},finish:{title:"完成",text:"完成"},undo:{title:"删除最后一个点",text:"删除最后一个点"},buttons:{polyline:"线",polygon:"多边形",rectangle:"矩形",circle:"圆",marker:"点"}},handlers:{circle:{tooltip:{start:"点击并拖动以绘制圆"},radius:"半径"},marker:{tooltip:{start:"点击放置点"}},polygon:{tooltip:{start:"点击开始绘制",cont:"点击继续绘制",end:"双击结束绘制"}},polyline:{error:"<strong>错误:<\/strong>图形边界不能相交!",tooltip:{start:"点击开始绘制线",cont:"点击继续绘制",end:"双击结束绘制"}},rectangle:{tooltip:{start:"点击并拖动以绘制矩形"}},simpleshape:{tooltip:{end:"释放鼠标以完成绘制"}}}},edit:{toolbar:{actions:{save:{title:"保存更改",text:"保存"},cancel:{title:"放弃编辑，放弃所有的更改。",text:"取消"}},buttons:{edit:"编辑图层",editDisabled:"停止编辑",remove:"删除图层",removeDisabled:"没有可以删除的图层"}},handlers:{edit:{tooltip:{text:"拖动节点进行编辑",subtext:"点击取消以放弃更改"}},remove:{tooltip:{text:"点击要素进行平移"}}}}}))}var commonTool={urlArgs:function(){var t=location.search.toLowerCase(),i={},r,n;if(t.indexOf("?")!=-1)for(r=t.substr(1),strs=r.split("&"),n=0;n<strs.length;n++)i[strs[n].split("=")[0]]=unescape(strs[n].split("=")[1]);return i}(),getQueryString:function(n){return CommonTool.queryString[n.toLowerCase()]},info:{showError:function(n){toastr.error(n)},showSuccess:function(n){toastr.success(n)},showInfo:function(n){toastr.info(n)},showWarning:function(n){toastr.warning(n)}}},jxgis=typeof jxgis=="undefined"?{}:jxgis,__events__,__Events__;jxgis.com=commonTool,function(){function u(n){dojo.mixin(i,n)}function f(){return navigator.geolocation?!0:!1}function r(n){switch(n.code){case 1:return{error:n,code:1,message:"位置服务被拒绝"};case 2:return{code:2,message:"暂时获取不到位置信息"};case 3:return{error:n,code:3,message:"获取信息超时"};case 4:return{error:n,code:4,message:"未知错误"}}}function e(u,f){if(n)return navigator.geolocation.getCurrentPosition(u,function(n){var t=r(n);f?f(t):console.error(t.message)},i);console.error(t)}function o(u,f){if(n)return navigator.geolocation.watchPosition(u,function(n){var t=r(n);f?f(t):console.error(t.message)},i);console.error(t)}function s(i){n?navigator.geolocation.clear(i):console.error(t)}jxgis=typeof jxgis=="undefined"?{}:jxgis;var n=f(),t="browser is not support",i={enableHighAccuracy:!0,timeout:5e3,maximumAge:1e3};jxgis.geolocation={isSupport:n,setOptions:u,get:e,watch:o,clearWatch:s}}(),typeof String.prototype.startsWith!="function"&&(String.prototype.startsWith=function(n){return this.slice(0,n.length)===n}),typeof String.prototype.endsWith!="function"&&(String.prototype.endsWith=function(n){return this.indexOf(n,this.length-n.length)!==-1});const _const_={atv:"active",tgt:"target",ept:""};__events__={on:function(n,t,i){var o=is.array(n),f=is.string(n),r,e,u;if(o||f)for(n=f?n.replace(/^\s+|\s+$/g,"").split(/\s+/):n,r=0,e=n.length;r<e;r++)this._on(n[r],t,i);else for(u in n)this._on(u,n[u],t);return this},off:function(n,t,i){var u,r,f;if(n)if(typeof n=="object")for(u in n)this._off(u,n[u],t);else for(n=n.replace(/^\s+|\s+$/g,"").split(/\s+/),r=0,f=n.length;r<f;r++)this._off(n[r],t,i);else delete this._events;return this},_on:function(n,t,i){var r,e,u,f,o;for(this._events=this._events||{},r=this._events[n],r||(r={listeners:[],count:0},this._events[n]=r),i===this&&(i=undefined),e={fn:t,ctx:i},u=r.listeners,f=0,o=u.length;f<o;f++)if(u[f].fn===t&&u[f].ctx===i)return;u.push(e),r.count++},_off:function(n,t,i){var f,r,u,e,o;if(this._events&&(f=this._events[n],f)){if(r=f.listeners,!t){for(u=0,e=r.length;u<e;u++)r[u].fn=L.Util.falseFn;delete this._events[n];return}if(i===this&&(i=undefined),r)for(u=0,e=r.length;u<e;u++)if((o=r[u],o.ctx===i)&&o.fn===t){o.fn=function(){return!1},f.count--,this._isFiring&&(r=r.slice()),r.splice(u,1);return}}},fire:function(n,t){var e,r,u,i,o,f;if(!this.listens(n))return this;if(e={data:t,type:n,target:this},this._events&&(r=this._events[n],r)){for(this._isFiring=!0,u=r.listeners,i=0,o=u.length;i<o;i++)f=u[i],f.fn.call(f.ctx||this,e);this._isFiring=!1}return this},listens:function(n){var t=this._events&&this._events[n];return t&&t.count?!0:!1},once:function(n,t,i){var r,u;if(typeof n=="object"){for(r in n)this.once(r,n[r],t);return this}u=function(){this.off(n,t,i).off(n,u,i)}.bind(this);return this.on(n,t,i).on(n,u,i)}},__Events__=function(){},__extend__(__Events__.prototype,__events__),window.React&&React.Component&&React.Component.prototype&&__extend__(React.Component.prototype,__events__),__ReactExtends__={_bindFuns:function(n){for(var i,t=0,r=n.length;t<r;t++)i=n[t],this[i]&&(this[i]=this[i].bind(this))},_getUpdateStateFun:function(n){return function(){return n}},_getClass:function(n){return typeof n=="function"?!n()?_const_.ept:_const_.atv:!n?_const_.ept:_const_.atv},_stopEvent:function(n){n.stopPropagation(),n.nativeEvent.stopImmediatePropagation()},_bringToFront:function(){var n=ReactDOM.findDOMNode(this);n.parentElement.appendChild(n)}},window.React&&React.Component&&React.Component.prototype&&__extend__(React.Component.prototype,__ReactExtends__),__leafletExtends__()